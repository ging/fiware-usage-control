<source>
  @type syslog
  port 24224
  tag flink-master
  <parse>
    message_format rfc3164
  </parse>
</source>
<filter flink-master.user.*>
  @type grep
  <regexp>
    key message
    pattern /org\.apache\.flink\.runtime\.executiongraph\.ExecutionGraph .*CREATED to SCHEDULED/
  </regexp>
</filter>
<source>
  @type syslog
  port 24225
  tag flink-worker
  <parse>
    message_format rfc3164
  </parse>
</source>
<filter flink-worker.user.*>
  @type grep
  <regexp>
    key message
    pattern /io\.netty\.handler\.logging\.LoggingHandler/
  </regexp>
</filter>
<match **>
  @type file
  path /fluentd/log
</match>
<match flink-master.user.*>
  @type kafka2
  brokers kafka_1:9092
  default_topic graph
  topic_key graph
  <format>
    @type json
  </format>
  <buffer events>
    flush_mode immediate
  </buffer>
</match>

<match flink-worker.user.*>
  @type kafka2
  brokers kafka_1:9092
  default_topic events
  topic_key events
  <format>
    @type json
  </format>
  <buffer events>
    flush_mode immediate
  </buffer>
</match>

